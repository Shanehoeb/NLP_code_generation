2023-06-18 23:22:59,181 INFO    MainThread:34819 [wandb_setup.py:_flush():68] Configure stats pid to 34819
2023-06-18 23:22:59,182 INFO    MainThread:34819 [wandb_setup.py:_flush():68] Loading settings from /root/.config/wandb/settings
2023-06-18 23:22:59,182 INFO    MainThread:34819 [wandb_setup.py:_flush():68] Loading settings from /content/drive/MyDrive/NLP_PROJECT/latent-diffusion-for-language/wandb/settings
2023-06-18 23:22:59,182 INFO    MainThread:34819 [wandb_setup.py:_flush():68] Loading settings from environment variables: {'_require_service': 'True'}
2023-06-18 23:22:59,183 INFO    MainThread:34819 [wandb_setup.py:_flush():68] Inferring run settings from compute environment: {'program_relpath': 'train_text_diffusion.py', 'program': '/content/drive/MyDrive/NLP_PROJECT/latent-diffusion-for-language/train_text_diffusion.py'}
2023-06-18 23:22:59,183 INFO    MainThread:34819 [wandb_setup.py:_flush():68] Applying login settings: {'mode': 'offline'}
2023-06-18 23:22:59,183 INFO    MainThread:34819 [wandb_init.py:_log_setup():476] Logging user logs to saved_models/codeparrot-clean/2023-06-18_23-22-50/wandb/offline-run-20230618_232259-2vwsmjjt/logs/debug.log
2023-06-18 23:22:59,184 INFO    MainThread:34819 [wandb_init.py:_log_setup():477] Logging internal logs to saved_models/codeparrot-clean/2023-06-18_23-22-50/wandb/offline-run-20230618_232259-2vwsmjjt/logs/debug-internal.log
2023-06-18 23:22:59,184 INFO    MainThread:34819 [wandb_init.py:init():516] calling init triggers
2023-06-18 23:22:59,185 INFO    MainThread:34819 [wandb_init.py:init():519] wandb.init called with sweep_config: {}
config: {}
2023-06-18 23:22:59,185 INFO    MainThread:34819 [wandb_init.py:init():569] starting backend
2023-06-18 23:22:59,185 INFO    MainThread:34819 [wandb_init.py:init():573] setting up manager
2023-06-18 23:22:59,192 INFO    MainThread:34819 [backend.py:_multiprocessing_setup():102] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2023-06-18 23:22:59,198 INFO    MainThread:34819 [wandb_init.py:init():580] backend started and connected
2023-06-18 23:22:59,206 INFO    MainThread:34819 [wandb_init.py:init():658] updated telemetry
2023-06-18 23:22:59,212 INFO    MainThread:34819 [wandb_init.py:init():728] starting run threads in backend
2023-06-18 23:23:04,221 INFO    MainThread:34819 [wandb_run.py:_console_start():1980] atexit reg
2023-06-18 23:23:04,222 INFO    MainThread:34819 [wandb_run.py:_redirect():1838] redirect: SettingsConsole.WRAP_RAW
2023-06-18 23:23:04,223 INFO    MainThread:34819 [wandb_run.py:_redirect():1903] Wrapping output streams.
2023-06-18 23:23:04,223 INFO    MainThread:34819 [wandb_run.py:_redirect():1925] Redirects installed.
2023-06-18 23:23:04,224 INFO    MainThread:34819 [wandb_init.py:init():765] run started, returning control to user process
2023-06-18 23:23:04,263 INFO    MainThread:34819 [wandb_run.py:_config_callback():1160] config_cb None None {'dataset_name': 'codeparrot-clean', 'save_dir': 'saved_models', 'output_dir': 'saved_models/codeparrot-clean/2023-06-18_23-22-50', 'wandb_name': None, 'corruption_prob': 0.0, 'train_batch_size': 64, 'eval_batch_size': 32, 'num_train_steps': 500000, 'gradient_accumulation_steps': 1, 'learning_rate': 0.0001, 'lr_schedule': 'cosine', 'lr_warmup_steps': 1000, 'adam_beta1': 0.9, 'adam_beta2': 0.999, 'adam_weight_decay': 1e-06, 'ema_decay': 0.9999, 'ema_update_every': 1, 'objective': 'pred_x0', 'loss_type': 'l1', 'beta_schedule': 'linear', 'p2_loss_weight_gamma': 0, 'timesteps': 1000, 'sampling_timesteps': 250, 'normalize_latent': True, 'save_and_sample_every': 5000, 'num_samples': 1000, 'self_condition': True, 'ddim_sampling_eta': 1, 'enc_dec_model': 'facebook/bart-base', 'tx_dim': 768, 'tx_depth': 12, 'scale_shift': True, 'disable_dropout': True, 'class_conditional': False, 'class_unconditional_prob': 0.1, 'amp': False, 'mixed_precision': 'no', 'eval': False, 'eval_test': False, 'resume_training': False, 'gen_data': False, 'resume_dir': None, 'milestone': 12, 'trainable_params': 214342272}
2023-06-18 23:23:13,347 WARNING MsgRouterThr:34819 [router.py:message_loop():77] message_loop has been closed
